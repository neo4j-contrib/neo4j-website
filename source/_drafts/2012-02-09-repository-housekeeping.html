---
layout: post
title: "Repository Housekeeping"
date: 2012-02-09
comments: false
---

<div class='post'>
At Neo Technology, we've started spring cleaning early - right in the middle of the cold snap.<br /><br />Over time we'd ended up with several Repository Managers:<br /><ul><li>a Nexus server that we share snapshots from, for our open source contributors</li><li>a staging repository for our Jenkins servers to stage artifacts from,</li><li>an extra domain name and some Apache magic to keep backward compatibility with an old address.</li></ul>Anders and I wanted to clean things, up so we designed a new scheme of repositories:<br /><br /><ul><li><a href="http://m2.neo4j.org/content/repositories/snapshots/">/snapshots</a> &nbsp;- Neo4j snapshots built by our Jenkins server.</li><li><a href="http://m2.neo4j.org/content/repositories/releases/">/releases</a> &nbsp; - Neo4j releases</li><li><a href="http://m2.neo4j.org/content/repositories/thirdparty/">/thirdparty</a> - Third party dependencies that may not be in Central yet.</li><li><a href="http://m2.neo4j.org/content/groups/everything/">/everything</a> - A repository group containing all the above.</li></ul>The last repository is a group that is composed of all the repositories that matter. So if you're in a hurry to build any of our code, you can configure Maven or Ivy to resolve everything at the /everything group.<br /><br /><br /><br />We had to choose one authoratitve domain name for the server.&nbsp; We chose m2.neo4j.org, and we made <a href="http://repo.neo4j.org/" target="_blank">http://repo.neo4j.org</a> redirect to <a href="http://m2.neo4j.org/" target="_blank">http://m2.neo4j.org</a> (the same thing works for HTTPS connections).&nbsp; We had ended up resolving artifacts in 4 seperate places, so we've added HTTP redirects to redirect old queries to /everything. We'll end up paying a little more in bandwidth, but we think of it as giving back to the open source community.<br /><br /><br />We use this repo server ourselves for Continuous Integration.&nbsp; Most of our CI builds run on a new Amazon EC2 instance, with no cached artifacts. &nbsp;Missing dependencies will cause our builds to fail, and<br />we'll notice.<br /><br />We use Puppet to build all of our new servers.&nbsp; We can roll out these servers at any time, and have minimal backups on the machine, as the only thing that we need to look out for is configuration, snapshots, and releases.&nbsp; In the event of an issue we're able to roll out the same animal again and again.</div>
